{% extends 'bonds/base.html' %}
{% block content %}
<div class="section">
  <div class="container">
    <div class="row">
      <div class="col s12 m9">
        <div class="card">
          <div class="card-content purple white-text">
            <h2>{{syndicate.name}}</h2>
          </div>
          <div class="card-content white">
            <span class="card-title activator">Investment: £{{ group_invested }} - Winnings: £{{ group_winnings }}</span>
            <p>Owned By: <b>{{syndicate.owner.first_name}}</b></p>
            <p>Members: <b>
                {% for userprofile in group_members %}
                {{ userprofile.user.first_name }}
                {% if not forloop.last %},
                {% endif %}
                {% endfor %}
              </b>
            </p>
          </div>
          <div class="card-action">
            <a class="waves-effect waves-light btn activator"><i class="material-icons left">payment</i>Buy Bonds</a>
            {% if request.user == syndicate.owner %}
            <form class="right" action="delete" method="POST">
              {% csrf_token %}
              <button type="submit" class="waves-effect waves-light btn red"><i class="material-icons left">delete</i>Delete Group</button>
            </form>
            
            {% else %}
            <a class="waves-effect waves-light btn red right"><i class="material-icons left">delete</i>Leave Group</a>
            {% endif %}
          </div>
          <div class="card-reveal">
            <span class="card-title grey-text text-darken-4">Buy Bonds<i class="material-icons right">close</i></span>
            <br>
            <form action="invest" method="POST">
              {% csrf_token %}
              <label for="amount_input">Slide to select purchase amount:</label>
              <p class="range-field">
                <input type="range" name="amount" id="amount_input" value="0" oninput="amount_id.value = amount_input.value" min="0" max="{{ user_profile.balance }}" />
              </p>
              <br>
              <h4 class="grey-text">
                Confirm purchase of £<output class="teal-text" name="amount_output" id="amount_id">0</output> worth of bonds?
              </h4>
              <button type="submit" class="waves-effect waves-light btn">Confirm</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col s12 m4">
        <div class="card">
          <div class="card-content">
            <span class="card-title">Group Shares</span>
            <table>
              <tr>
                <th>Member</th>
                <th>Investment</th>
              </tr>
              {% for user_investment in bonds_per_user %}
              <tr>
                <td>{{ user_investment.name }}</td>
                <td>£{{ user_investment.investment }}</td>
              </tr>
              {% endfor %}
            </table>
          </div>
        </div>
      </div>
      
      <div class="col s12 m5">
        <div class="card">
          <div class="card-content">
            <span class="card-title">Your Investment:</span>
            <h3>£{{ user_invested }} </h3>
            <span class="card-title">Your Winnings:</span>
            <h3>£{{ user_winnings }} </h3>
          </div>
        </div>
      </div>
    </div>
    </div>
  </div>
</div>

{% endblock %}
